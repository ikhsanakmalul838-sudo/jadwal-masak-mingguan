<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aplikasi Tabungan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ğŸŠ Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
      body {
        background: linear-gradient(to right, #d1fae5, #fef9c3);
        min-height: 100vh;
      }
      .card {
        animation: pop 0.4s ease-in-out;
      }
      @keyframes pop {
        from {
          transform: scale(0.9);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }
      .progress-animate {
        transition: width 0.6s ease-in-out;
      }
    </style>
  </head>
  <body class="flex flex-col items-center py-10 px-4">
    <h1
      class="text-5xl font-extrabold mb-6 text-green-700 drop-shadow-lg text-center"
    >
      ğŸ’° Aplikasi Tabungan
    </h1>
    <p class="mb-8 text-lg text-gray-700 italic text-center">
      â€œSedikit demi sedikit, lama-lama menjadi bukit ğŸ”ï¸â€
    </p>

    <!-- Form Input -->
    <div
      class="bg-white/90 backdrop-blur p-6 rounded-2xl shadow-2xl w-full max-w-md mb-6 border-4 border-green-300"
    >
      <h2 class="text-xl font-bold mb-4 text-green-600">â• Tambah Tabungan</h2>

      <label class="block mb-2 font-semibold">ğŸ“… Tanggal</label>
      <input id="date" type="date" class="w-full border rounded-lg p-2 mb-4" />

      <label class="block mb-2 font-semibold">ğŸ’µ Jumlah Tabungan (Rp)</label>
      <input
        id="amount"
        type="number"
        class="w-full border rounded-lg p-2 mb-4"
        placeholder="Masukkan jumlah uang"
      />

      <label class="block mb-2 font-semibold">ğŸ“ Keterangan</label>
      <input
        id="note"
        type="text"
        class="w-full border rounded-lg p-2 mb-4"
        placeholder="Misal: gaji, jajan, bonus"
      />

      <button
        onclick="addSaving()"
        class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold px-4 py-3 rounded-xl shadow hover:scale-105 transition"
      >
        Tambah Tabungan
      </button>
    </div>

    <!-- Target Tabungan -->
    <div
      class="bg-white/90 backdrop-blur p-6 rounded-2xl shadow-2xl w-full max-w-md mb-6 border-4 border-yellow-300"
    >
      <h2 class="text-xl font-bold mb-3 text-yellow-700">ğŸ¯ Target Tabungan</h2>
      <input
        id="target"
        type="number"
        class="w-full border rounded-lg p-2 mb-4"
        placeholder="Masukkan target (Rp)"
      />
      <button
        onclick="setTarget()"
        class="w-full bg-yellow-500 text-white px-4 py-2 rounded-xl font-bold hover:bg-yellow-600"
      >
        Simpan Target
      </button>

      <div class="mt-6">
        <p class="font-bold text-lg">
          Target: <span id="targetDisplay" class="text-yellow-700">Rp 0</span>
        </p>
        <div class="w-full bg-gray-200 rounded-full h-6 mt-3 shadow-inner">
          <div
            id="progressBar"
            class="progress-animate bg-gradient-to-r from-green-400 to-emerald-600 h-6 rounded-full text-xs text-white text-center leading-6"
          >
            0%
          </div>
        </div>
        <p
          id="motivation"
          class="mt-3 text-center font-semibold text-green-600"
        >
          Ayo semangat menabung! ğŸš€
        </p>
      </div>
    </div>

    <!-- Total -->
    <div
      class="bg-gradient-to-r from-emerald-400 to-green-500 text-white p-6 rounded-2xl shadow-lg mb-6 border-2 border-green-700 text-center"
    >
      <h2 class="text-2xl font-bold">Total Tabungan</h2>
      <p id="total" class="text-4xl font-extrabold mt-2">Rp 0</p>
    </div>

    <!-- Daftar Tabungan -->
    <div
      class="bg-white/90 backdrop-blur p-6 rounded-2xl shadow-xl w-full max-w-2xl border-4 border-green-300"
    >
      <h2 class="text-2xl font-bold mb-4 text-green-700">
        ğŸ“‹ Riwayat Tabungan
      </h2>
      <ul id="savingList" class="space-y-3"></ul>
    </div>

    <!-- Tombol Reset -->
    <button
      onclick="resetSavings()"
      class="mt-6 bg-red-600 text-white px-6 py-3 rounded-xl shadow-lg font-bold hover:bg-red-700"
    >
      ğŸ”„ Reset Semua Tabungan
    </button>

    <script>
      let savings = JSON.parse(localStorage.getItem("savings")) || [];
      let target = JSON.parse(localStorage.getItem("target")) || 0;

      function formatRupiah(angka) {
        return new Intl.NumberFormat("id-ID").format(angka);
      }

      function saveSavings() {
        localStorage.setItem("savings", JSON.stringify(savings));
        renderSavings();
      }

      function addSaving() {
        const date =
          document.getElementById("date").value ||
          new Date().toISOString().split("T")[0];
        const amount = parseInt(document.getElementById("amount").value);
        const note = document.getElementById("note").value;

        if (!amount || amount <= 0) {
          alert("Masukkan jumlah tabungan yang valid!");
          return;
        }

        savings.push({ date, amount, note });
        saveSavings();

        document.getElementById("amount").value = "";
        document.getElementById("note").value = "";
      }

      function deleteSaving(index) {
        savings.splice(index, 1);
        saveSavings();
      }

      function resetSavings() {
        if (confirm("Apakah yakin ingin menghapus semua tabungan?")) {
          savings = [];
          saveSavings();
        }
      }

      function setTarget() {
        const input = document.getElementById("target").value;
        if (!input || input <= 0) {
          alert("Masukkan target yang valid!");
          return;
        }
        target = parseInt(input);
        localStorage.setItem("target", target);
        renderSavings();
      }

      function showConfetti() {
        var duration = 2 * 1000;
        var end = Date.now() + duration;

        (function frame() {
          confetti({
            particleCount: 7,
            angle: 60,
            spread: 55,
            origin: { x: 0 },
          });
          confetti({
            particleCount: 7,
            angle: 120,
            spread: 55,
            origin: { x: 1 },
          });
          if (Date.now() < end) {
            requestAnimationFrame(frame);
          }
        })();
      }

      function renderSavings() {
        const list = document.getElementById("savingList");
        const total = document.getElementById("total");
        const targetDisplay = document.getElementById("targetDisplay");
        const progressBar = document.getElementById("progressBar");
        const motivation = document.getElementById("motivation");

        list.innerHTML = "";

        let sum = 0;
        savings.forEach((item, index) => {
          sum += item.amount;

          let li = document.createElement("li");
          li.className =
            "card flex justify-between items-center bg-green-50 p-4 rounded-xl shadow-md border border-green-200";

          li.innerHTML = `
          <div>
            <p class="font-bold text-lg text-green-700">ğŸ“… ${item.date}</p>
            <p class="text-gray-800">ğŸ’µ Rp ${formatRupiah(
              item.amount
            )} <span class="text-gray-500">(${item.note || "-"})</span></p>
          </div>
          <button onclick="deleteSaving(${index})" class="bg-red-400 text-white px-3 py-1 rounded-lg hover:bg-red-500">
            âŒ Hapus
          </button>
        `;
          list.appendChild(li);
        });

        total.textContent = "Rp " + formatRupiah(sum);

        // Update target
        targetDisplay.textContent = "Rp " + formatRupiah(target);

        let progress =
          target > 0 ? Math.min(100, Math.round((sum / target) * 100)) : 0;
        progressBar.style.width = progress + "%";
        progressBar.textContent = progress + "%";

        // Motivasi dinamis
        if (progress === 0) {
          motivation.textContent = "Yuk mulai menabung hari ini! ğŸŒ±";
        } else if (progress < 50) {
          motivation.textContent = "Mantap ğŸ‘ teruskan, target makin dekat!";
        } else if (progress < 100) {
          motivation.textContent =
            "Hebat ğŸ’ª tinggal sedikit lagi menuju target!";
        } else {
          motivation.textContent =
            "ğŸ‰ Selamat! Target tabungan sudah tercapai!";
          showConfetti(); // ğŸŠ Munculkan confetti
        }
      }

      renderSavings();
    </script>
  </body>
</html>
